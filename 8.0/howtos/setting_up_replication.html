



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation">
      
      
        <meta name="author" content="Percona LLC">
      
      
        <link rel="canonical" href="https://docs.percona.com/percona-xtrabackup-docs/8.0/8.0/howtos/setting_up_replication.html">
      
      <link rel="icon" href="../_static/percona_favicon.ico">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.1">
    
    
      
        <title>How to set up a replica for replication in 6 simple steps with Percona XtraBackup - Percona XtraBackup</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.3/css/line.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="../css/percona.css">
    
      <link rel="stylesheet" href="../css/version-select.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-343802-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){if(document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document.forms.feedback){var e,a=document.forms.feedback;for(e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-set-up-a-replica-for-replication-in-6-simple-steps-with-percona-xtrabackup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://percona.com/software/documentation" class="md-header__button md-logo" aria-label="Percona XtraBackup" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis"><a href="https://www.percona.com/software/documentation">
            Percona Product Documentation
          </a></span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How to set up a replica for replication in 6 simple steps with Percona XtraBackup
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent="" type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="" type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/percona/pxb-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxb-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Percona XtraBackup" class="md-nav__button md-logo" aria-label="Percona XtraBackup" data-md-component="logo">
      
  <img src="../_static/percona-logo.svg" alt="logo">

    </a>
    Percona XtraBackup
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/percona/pxb-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/pxb-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Percona XtraBackup - Documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Introduction
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intro.html" class="md-nav__link">
        About Percona XtraBackup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how_xtrabackup_works.html" class="md-nav__link">
        How Percona XtraBackup Works
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/apt_repo.html" class="md-nav__link">
        Installing Percona XtraBackup on Debian and Ubuntu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/yum_repo.html" class="md-nav__link">
        Installing Percona XtraBackup on Red Hat Enterprise Linux and CentOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/binary-tarball.html" class="md-nav__link">
        Installing Percona XtraBackup from a Binary Tarball
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/compiling_xtrabackup.html" class="md-nav__link">
        Compiling and Installing from Source Code
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Run in Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Run in Docker" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Run in Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/docker.html" class="md-nav__link">
        Running Percona XtraBackup in a Docker container
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          How Percona XtraBackup works
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How Percona XtraBackup works" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          How Percona XtraBackup works
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/implementation_details.html" class="md-nav__link">
        Implementation Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../using_xtrabackup/privileges.html" class="md-nav__link">
        Connection and Privileges Needed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../using_xtrabackup/configuring.html" class="md-nav__link">
        Configuring xtrabackup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../using_xtrabackup/comparison.html" class="md-nav__link">
        Server Version and Backup Version Comparison
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/xtrabackup_exit_codes.html" class="md-nav__link">
        xtrabackup Exit Codes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Backup Scenarios
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Backup Scenarios" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Backup Scenarios
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backup_scenarios/full_backup.html" class="md-nav__link">
        The Backup Cycle - Full Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backup_scenarios/incremental_backup.html" class="md-nav__link">
        Incremental Backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backup_scenarios/compressed_backup.html" class="md-nav__link">
        Compressed Backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/partial_backups.html" class="md-nav__link">
        Partial Backups
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          User’s Manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User’s Manual" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          User’s Manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../manual.html" class="md-nav__link">
        Percona XtraBackup User Manual
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Advanced Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced Features" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Advanced Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/throttling_backups.html" class="md-nav__link">
        Throttling Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/encrypted_innodb_tablespace_backups.html" class="md-nav__link">
        Encrypted InnoDB tablespace backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/backup.encrypting.html" class="md-nav__link">
        Encrypting Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/lru_dump.html" class="md-nav__link">
        LRU dump backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/point-in-time-recovery.html" class="md-nav__link">
        Point-In-Time recovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/working_with_binary_logs.html" class="md-nav__link">
        Working with Binary Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/log_enhancements.html" class="md-nav__link">
        Improved Log statements
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Security
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Security" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Security
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/pxb-selinux.html" class="md-nav__link">
        Working with SELinux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../security/pxb-apparmor.html" class="md-nav__link">
        Working with AppArmor
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Auxiliary guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Auxiliary guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Auxiliary guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="enabling_tcp.html" class="md-nav__link">
        Enabling the server to communicate via TCP/IP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ssh_server.html" class="md-nav__link">
        Installing and configuring an SSH server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/analyzing_table_statistics.html" class="md-nav__link">
        Analyzing Table Statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/flush-tables-with-read-lock.html" class="md-nav__link">
        `FLUSH TABLES WITH READ LOCK` option
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/locks.html" class="md-nav__link">
        `lock-ddl-per-table` option improvements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/page_tracking.html" class="md-nav__link">
        Incremental backup using page tracking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          xbcloud Binary
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="xbcloud Binary" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          xbcloud Binary
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud.html" class="md-nav__link">
        The xbcloud Binary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_swift.html" class="md-nav__link">
        Using the xbcloud Binary with Swift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_s3.html" class="md-nav__link">
        Using xbcloud Binary with Amazon S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_minio.html" class="md-nav__link">
        Using the xbcloud binary with MinIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_gcs.html" class="md-nav__link">
        Using the xbcloud with Google Cloud Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_exbackoff.html" class="md-nav__link">
        Exponential Backoff
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcloud/xbcloud_azure.html" class="md-nav__link">
        Using the xbcloud binary with Microsoft Azure Cloud Storage
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          Tutorials, Recipes, How-tos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials, Recipes, How-tos" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Tutorials, Recipes, How-tos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-tos.html" class="md-nav__link">
        How-tos and Recipes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          Release notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Release notes" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Release notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes.html" class="md-nav__link">
        Percona XtraBackup 8.0 Release Notes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.29-22.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.29-22 (2022-07-19)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.28-21.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.28-21 (2022-05-25)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.28-20.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.28-20
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.27-19.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.27-19
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.26-18.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.26-18.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.25-17.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.25-17.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.23-16.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.23-16.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.22-15.0.html" class="md-nav__link">
        Percona XtraBackup 8.0.22-15.0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.14.html" class="md-nav__link">
        Percona XtraBackup 8.0.14
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.13.html" class="md-nav__link">
        Percona XtraBackup 8.0.13
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.12.html" class="md-nav__link">
        Percona XtraBackup 8.0.12
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.11.html" class="md-nav__link">
        Percona XtraBackup 8.0.11
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.10.html" class="md-nav__link">
        Percona XtraBackup 8.0.10
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.9.html" class="md-nav__link">
        Percona XtraBackup 8.0.9
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.8.html" class="md-nav__link">
        Percona XtraBackup 8.0.8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.7.html" class="md-nav__link">
        Percona XtraBackup 8.0.7
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.6.html" class="md-nav__link">
        Percona XtraBackup 8.0.6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.5.html" class="md-nav__link">
        Percona XtraBackup 8.0.5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0.4.html" class="md-nav__link">
        Percona XtraBackup 8.0.4
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/8.0/8.0-3-rc1.html" class="md-nav__link">
        Percona XtraBackup 8.0-3-rc1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          Error message descriptions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Error message descriptions" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Error message descriptions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../em/instant.html" class="md-nav__link">
        Error Message: Found tables with row versions due to INSTANT ADD/DROP columns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_15" type="checkbox" id="__nav_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_15">
          References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="References" data-md-level="1">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup_bin/xbk_option_reference.html" class="md-nav__link">
        The xtrabackup Option Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbcrypt/xbcrypt.html" class="md-nav__link">
        The xbcrypt binary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xbstream/xbstream.html" class="md-nav__link">
        The xbstream binary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq.html" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../glossary.html" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../xtrabackup-files.html" class="md-nav__link">
        Index of files created by Percona XtraBackup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trademark-policy.html" class="md-nav__link">
        Trademark Policy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../version-check.html" class="md-nav__link">
        Version Checking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
   <label class="md-nav__title" for="__drawer">
    <a href="https://learn.percona.com/download-percona-xtrabackup-8.0-manual" onclick="_gaq.push(['b._trackEvent', 'Percona XtraBackup', 'Download', 'Download Manual Percona XtraBackup']);" class="md-nav__link md-nav__link--active">
      Download PDF
    </a>
  </label> 
  </ul>
</nav>

                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#all-the-things-you-will-need" class="md-nav__link">
    All the things you will need
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#version-updates" class="md-nav__link">
    Version updates
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-make-a-backup-on-the-source-and-prepare-it" class="md-nav__link">
    STEP 1: Make a backup on the Source and prepare it
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-copy-backed-up-data-to-the-replica" class="md-nav__link">
    STEP 2:  Copy backed up data to the Replica
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-configure-the-sources-mysql-server" class="md-nav__link">
    STEP 3: Configure the Source’s MySQL server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-configure-the-replicas-mysql-server" class="md-nav__link">
    STEP 4: Configure the Replica’s MySQL server
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-5-start-the-replication" class="md-nav__link">
    STEP 5: Start the replication
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-6-check" class="md-nav__link">
    STEP 6: Check
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-more-replicas-to-the-source" class="md-nav__link">
    Adding more replicas to the Source
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

                <!-- Edit button -->
                
                  <a
                    href="https://github.com/percona/pxb-docs/edit/8.0/docs/howtos/setting_up_replication.md"
                    title="Edit this page"
                    class="md-content__button md-icon"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
                  </a>
                

                <!--
                  Hack: check whether the content contains a h1 headline. If it
                  doesn't, the page title (or respectively site name) is used
                  as the main headline.
                -->
                

                <!-- Markdown content -->
                <h1 id="how-to-set-up-a-replica-for-replication-in-6-simple-steps-with-percona-xtrabackup">How to set up a replica for replication in 6 simple steps with Percona XtraBackup<a class="headerlink" href="#how-to-set-up-a-replica-for-replication-in-6-simple-steps-with-percona-xtrabackup" title="Permanent link">&para;</a></h1>
<p>Data is, by far, the most valuable part of a system. Having a backup done
systematically and available for a rapid recovery in case of failure is
admittedly essential to a system. However, it is not common practice
because of
its costs, infrastructure needed or even the boredom associated to the
task. Percona XtraBackup is designed to solve this problem.</p>
<p>You can have almost real-time backups in 6 simple steps by setting up a
replication environment with Percona XtraBackup.</p>
<h2 id="all-the-things-you-will-need">All the things you will need<a class="headerlink" href="#all-the-things-you-will-need" title="Permanent link">&para;</a></h2>
<p>Setting up a replica for replication with <em>Percona XtraBackup</em> is a
straightforward procedure. In order to keep it simple, here is a list of
the
things you need to follow the steps without hassles:</p>
<p><code>Source</code></p>
<p>A system with a <em>MySQL</em>-based server installed, configured and running. This
system will be called <code>Source</code>, as it is where your data is stored and the one to be replicated. We will assume the following about this system:</p>
<ul>
<li>
<p>the <em>MySQL</em> server is able to communicate with others by the standard TCP/IP port;</p>
</li>
<li>
<p>the <em>SSH</em> server is installed and configured;</p>
</li>
<li>
<p>you have a user account in the system with the appropriate permissions;</p>
</li>
<li>
<p>you have a MySQL’s user account with appropriate privileges.</p>
</li>
<li>
<p>server has binlogs enabled and server-id set up to 1.</p>
</li>
</ul>
<p><code>Replica</code></p>
<p>Another system, with a <em>MySQL</em>-based server installed on it. We
will refer to this machine as <code>Replica</code> and we will assume the same things
we did about <code>Source</code>, except that the server-id on <code>Replica</code> is 2.</p>
<p><code>Percona XtraBackup</code></p>
<p>The backup tool we will use. It should be installed in both computers for convenience.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not recommended to mix MySQL variants (Percona Server, MySQL) in your replication setup. This may produce incorrect <code>xtrabackup_slave_info</code> file when adding a new replica. </p>
</div>
<h2 id="version-updates">Version updates<a class="headerlink" href="#version-updates" title="Permanent link">&para;</a></h2>
<p>The 8.0.23 version deprecates the <code>CHANGE_MASTER_TO</code> command. In that 
version and later, use
the <a href="https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html">CHANGE_REPLICATION_SOURCE_TO and the appropriate options</a> instead.</p>
<p>The 8.0.22 version deprecates the<code>START SLAVE</code> command. In that version or 
later, use <code>START REPLICA</code> instead.</p>
<h2 id="step-1-make-a-backup-on-the-source-and-prepare-it">STEP 1: Make a backup on the <code>Source</code> and prepare it<a class="headerlink" href="#step-1-make-a-backup-on-the-source-and-prepare-it" title="Permanent link">&para;</a></h2>
<p>At the  <code>Source</code>, issue the following to a shell:</p>
<div class="highlight"><pre><span></span><code>$ xtrabackup --backup --user=yourDBuser --password=MaGiCdB1 --target-dir=/path/to/backupdir
</code></pre></div>
<p>After this is finished you should get:</p>
<div class="highlight"><pre><span></span><code>xtrabackup: completed OK!
</code></pre></div>
<p>This will make a copy of your <em>MySQL</em> data dir
to the <code>/path/to/backupdir</code> directory.
You have told <em>Percona XtraBackup</em> to connect to the database server
using your database user and password,
and do a hot backup of all your data in it
(all <em>MyISAM</em>, <em>InnoDB</em> tables and indexes in them).</p>
<p>In order for snapshot to be consistent you need to prepare the data on the
source:</p>
<div class="highlight"><pre><span></span><code>$ xtrabackup --user=yourDBuser --password=MaGiCdB1 \
            --prepare --target-dir=/path/to/backupdir
</code></pre></div>
<p>You need to select path where your snapshot has been taken.
If everything is ok you should get the same OK message.
Now the transaction logs are applied to the data files,
and new ones are created:
your data files are ready to be used by the MySQL server.</p>
<p><em>Percona XtraBackup</em> knows where your data is by reading your my.cnf file.
If you have your configuration file in a non-standard place,
you should use the flag <code>--defaults-file</code> <code>=/location/of/my.cnf</code>.</p>
<p>If you want to skip writing the username and password
every time you want to access <em>MySQL</em>,
you can set it up in <code>.mylogin.cnf</code> as follows:</p>
<div class="highlight"><pre><span></span><code>mysql_config_editor set --login-path=client --host=localhost --user=root --password
</code></pre></div>
<p>For more information, see MySQL Configuration
Utility <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-config-editor.html">https://dev.mysql.com/doc/refman/8.0/en/mysql-config-editor.html</a>.</p>
<p>This statement provides root access to MySQL.</p>
<h2 id="step-2-copy-backed-up-data-to-the-replica">STEP 2:  Copy backed up data to the Replica<a class="headerlink" href="#step-2-copy-backed-up-data-to-the-replica" title="Permanent link">&para;</a></h2>
<p>On the Source, use rsync or scp to copy the data from the Source to the
Replica. If you are syncing the data directly to replica’s data directory,
we recommend that you stop the <code>mysqld</code> there.</p>
<div class="highlight"><pre><span></span><code>$ rsync -avpP -e ssh /path/to/backupdir Replica:/path/to/mysql/
</code></pre></div>
<p>After data has been copied, you can back up the original or previously
installed <em>MySQL</em> datadir (<strong>NOTE</strong>: Make sure mysqld is shut down before
you move the contents of its datadir, or move the snapshot into its
datadir.). Run the following commands on the Replica:</p>
<div class="highlight"><pre><span></span><code>$ mv /path/to/mysql/datadir /path/to/mysql/datadir_bak
</code></pre></div>
<p>and move the snapshot from the <code>Source</code> in its place:</p>
<div class="highlight"><pre><span></span><code>$ xtrabackup --move-back --target-dir=/path/to/mysql/backupdir
</code></pre></div>
<p>After you copy data over, make sure the Replica <em>MySQL</em> has the proper
permissions to access them.</p>
<div class="highlight"><pre><span></span><code>$ chown mysql:mysql /path/to/mysql/datadir
</code></pre></div>
<p>If the ibdata and iblog files are located in directories outside the
datadir, you must put these files in their proper place after the logs have
been applied.</p>
<h2 id="step-3-configure-the-sources-mysql-server">STEP 3: Configure the Source’s MySQL server<a class="headerlink" href="#step-3-configure-the-sources-mysql-server" title="Permanent link">&para;</a></h2>
<p>On the source, run the following command to add the appropriate grant. This
grant allows the replica to be able to connect to source:</p>
<div class="highlight"><pre><span></span><code>&gt; GRANT REPLICATION SLAVE ON *.*  TO &#39;repl&#39;@&#39;$replicaip&#39;
IDENTIFIED BY &#39;$replicapass&#39;;
</code></pre></div>
<p>Also make sure that firewall rules are correct and that the <code>Replica</code> can
connect to the <code>Source</code>. Run the following command on the Replica to test
that you can run the mysql client on <code>Replica</code>, connect to the <code>Source</code>,
and authenticate.</p>
<div class="highlight"><pre><span></span><code>$ mysql --host=Source --user=repl --password=$replicapass
</code></pre></div>
<p>Verify the privileges.</p>
<div class="highlight"><pre><span></span><code>mysql&gt; SHOW GRANTS;
</code></pre></div>
<h2 id="step-4-configure-the-replicas-mysql-server">STEP 4: Configure the Replica’s MySQL server<a class="headerlink" href="#step-4-configure-the-replicas-mysql-server" title="Permanent link">&para;</a></h2>
<p>Copy the <code>my.cnf</code> file from the <code>Source</code> to the <code>Replica</code>:</p>
<div class="highlight"><pre><span></span><code>$ scp user@Source:/etc/mysql/my.cnf /etc/mysql/my.cnf
</code></pre></div>
<p>and change the following options in /etc/mysql/my.cnf:</p>
<div class="highlight"><pre><span></span><code>server-id=2
</code></pre></div>
<p>and start/restart mysqld on the <code>Replica</code>.</p>
<p>In case you’re using init script on Debian-based system to start mysqld, be
sure that the password for <code>debian-sys-maint</code> user has been updated, and
it’s the same as that user’s password on the <code>Source</code>. Password can be seen
and updated in <code>/etc/mysql/debian.cnf</code>.</p>
<h2 id="step-5-start-the-replication">STEP 5: Start the replication<a class="headerlink" href="#step-5-start-the-replication" title="Permanent link">&para;</a></h2>
<p>On the <code>Replica</code>, review the content of the file <code>xtrabackup_binlog_info</code>,
it will be something like:</p>
<div class="highlight"><pre><span></span><code> $ cat /var/lib/mysql/xtrabackup_binlog_info
Source-bin.000001     481
</code></pre></div>
<p><a href="#version-updates">The term <code>master</code> is deprecated</a>. Do the following on a 
MySQL console and use the username and
password you’ve set up in STEP 3 :</p>
<ul>
<li>
<p>Version 8.0.23 or later, use the <code>CHANGE_REPLICATION_SOURCE_TO</code> statement</p>
</li>
<li>
<p>Before 8.0.23, use the <code>CHANGE MASTER</code> statement</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>CHANGE REPLICATION SOURCE TO
    SOURCE_HOST=&#39;$sourceip&#39;,
    SOURCE_USER=&#39;repl&#39;,
    SOURCE_PASSWORD=&#39;$replicapass&#39;,
    SOURCE_LOG_FILE=&#39;Source-bin.000001&#39;,
    SOURCE_LOG_POS=481;
</code></pre></div>
<p>Start the replica:</p>
<div class="highlight"><pre><span></span><code>START REPLICA;
</code></pre></div>
<p>The <a href="#version-updates">term <code>slave</code> is deprecated</a>. Do the following:</p>
<ul>
<li>Version 8.0.22 or later, use <code>START REPLICA</code></li>
<li>Before version 8.0.22, use <code>START SLAVE</code></li>
</ul>
<h2 id="step-6-check">STEP 6: Check<a class="headerlink" href="#step-6-check" title="Permanent link">&para;</a></h2>
<p>On the <code>Replica</code>, check that everything went OK with:</p>
<div class="highlight"><pre><span></span><code>SHOW REPLICA STATUS\G
</code></pre></div>
<p>The result shows the status:</p>
<div class="highlight"><pre><span></span><code>Slave_IO_Running: Yes
Slave_SQL_Running: Yes
Seconds_Behind_Master: 13
</code></pre></div>
<p>Both <code>IO</code> and <code>SQL</code> threads need to be running. The <code>Seconds_Behind_Master</code>
means the <code>SQL</code> currently being executed has a <code>current_timestamp</code> of 13
seconds ago. It is an estimation of the lag between the <code>Source</code> and
the <code>Replica</code>. Note that at the beginning, a high value could be shown
because the <code>Replica</code> has to “catch up” with the <code>Source</code>.</p>
<h2 id="adding-more-replicas-to-the-source">Adding more replicas to the Source<a class="headerlink" href="#adding-more-replicas-to-the-source" title="Permanent link">&para;</a></h2>
<p>You can use this procedure with slight variation to add new replicas to a
source. We will use <em>Percona XtraBackup</em> to clone an already configured
replica. We will continue using the previous scenario for convenience, but
we will add a <code>NewReplica</code> to the plot.</p>
<p>At the <code>Replica</code>, do a full backup:</p>
<div class="highlight"><pre><span></span><code>$ xtrabackup --user=yourDBuser --password=MaGiCiGaM \
   --backup --slave-info --target-dir=/path/to/backupdir
</code></pre></div>
<p>By using the <code>--slave-info</code> <em>Percona XtraBackup</em> creates additional file
called <code>xtrabackup_slave_info</code>.</p>
<p>Apply the logs:</p>
<div class="highlight"><pre><span></span><code>$ xtrabackup --prepare --use-memory=2G --target-dir=/path/to/backupdir/
</code></pre></div>
<p>Copy the directory from the <code>Replica</code> to the <code>NewReplica</code> (<strong>NOTE</strong>: Make
sure mysqld is shut down on the <code>NewReplica</code> before you copy the contents
the snapshot into its datadir.):</p>
<div class="highlight"><pre><span></span><code>rsync -avprP -e ssh /path/to/backupdir NewReplica:/path/to/mysql/datadir
</code></pre></div>
<p>For example, to set up a new user, <code>user2</code>, you add another grant on
the Source:</p>
<div class="highlight"><pre><span></span><code>&gt; GRANT REPLICATION SLAVE ON *.*  TO &#39;user2&#39;@&#39;$newreplicaip&#39;
 IDENTIFIED BY &#39;$replicapass&#39;;
</code></pre></div>
<p>On the <code>NewReplica</code>, copy the configuration file from the <code>Replica</code>:</p>
<div class="highlight"><pre><span></span><code>$ scp user@Replica:/etc/mysql/my.cnf /etc/mysql/my.cnf
</code></pre></div>
<p>Make sure you change the server-id variable in <code>/etc/mysql/my.cnf</code> to 3 and
disable the replication on start:</p>
<div class="highlight"><pre><span></span><code>skip-slave-start
server-id=3
</code></pre></div>
<p>After setting <code>server_id</code>, start <strong>mysqld</strong>.</p>
<p>Fetch the master_log_file and master_log_pos from the
file <code>xtrabackup_slave_info</code>, execute the statement for setting up the
source and the log file for the NewReplica:</p>
<div class="highlight"><pre><span></span><code>&gt; CHANGE MASTER TO
     MASTER_HOST=&#39;$Sourceip&#39;,
     MASTER_USER=&#39;repl&#39;,
     MASTER_PASSWORD=&#39;$replicapass&#39;,
     MASTER_LOG_FILE=&#39;Source-bin.000001&#39;,
     MASTER_LOG_POS=481;
</code></pre></div>
<p><a href="#version-updates">The term <code>master</code> is deprecated</a>. Do the following 
and then start the replica:</p>
<ul>
<li>
<p>Version 8.0.23 or later, use the <code>CHANGE_REPLICATION_SOURCE_TO</code> statement</p>
</li>
<li>
<p>Before 8.0.23, use the <code>CHANGE MASTER</code> statement</p>
</li>
</ul>
<p><a href="#version-updates">The term <code>slave</code> is deprecated</a>. Do the following:</p>
<ul>
<li>Version 8.0.22 or later, use <code>START REPLICA</code>.</li>
<li>Before version 8.0.22, use <code>START SLAVE</code></li>
</ul>
<div class="highlight"><pre><span></span><code>&gt; START REPLICA;
</code></pre></div>
<p>If both IO and SQL threads are running when you check the <code>NewReplica</code>,
server is replicating the <code>Source</code>.</p>

                
<div class="md-relbar2__inner md-grid">
<div class="md-content">
  <article class="md-content__inner md-typeset" role="main">    
    <h4>Contact Us </h4>
       <p>For free technical help, visit the Percona <a class="reference external" href="https://forums.percona.com/c/mysql-mariadb/percona-xtrabackup/10?utm_campaign=Doc%20pages" target="_blank">Community Forum</a>.<br>
        <p>To report bugs or submit feature requests, open a <a class="reference external" href="https://jira.percona.com/projects/PXB/issues/" target="_blank">JIRA</a> ticket.<br>
         <p>For paid <a class="reference external" href="https://www.percona.com/services/support"> support </a> and <a class="reference external" href="https://www.percona.com/services/managed-services"> managed </a> or <a class="reference external" href="https://www.percona.com/services/consulting">consulting services </a>, contact <a class="reference external" href="https://www.percona.com/about-percona/contact" target="_blank">Percona Sales</a>.</p>
 </article>
</div>
</div>

                <!-- Last update of source file -->
                
                  
                    <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2022-08-01
    
  </small>
</div>
                  
                
              
            </article>
            
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Percona LLC, &#169; 2022
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "navigation.top", "content.tabs.link"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
        <script src="../js/version-select.js"></script>
      
    
  </body>
</html>